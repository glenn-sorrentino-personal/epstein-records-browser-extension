name: Data Sync Check

on:
  pull_request:
  push:
    branches:
      - main

jobs:
  verify-data-sync:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Verify browser data is synced from source-data
        run: |
          bash scripts/sync-data.sh
          git diff --exit-code -- \
            chrome/data/records.js chrome/data/names.txt chrome/data/mentions.txt \
            firefox/data/records.js firefox/data/names.txt firefox/data/mentions.txt \
            "safari/Epstein Records Indicator Safari/Epstein Records Indicator Safari Extension/Resources/data/records.js" \
            "safari/Epstein Records Indicator Safari/Epstein Records Indicator Safari Extension/Resources/data/names.txt" \
            "safari/Epstein Records Indicator Safari/Epstein Records Indicator Safari Extension/Resources/data/mentions.txt"
